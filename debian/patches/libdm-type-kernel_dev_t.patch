--- a/libdm/ioctl/libdm-compat.h
+++ b/libdm/ioctl/libdm-compat.h
@@ -19,6 +19,7 @@
 #include "kdev_t.h"
 #include "dm-ioctl.h"
 #include <inttypes.h>
+#include <linux/types.h>
 #include <sys/ioctl.h>
 
 struct dm_task;
@@ -40,7 +41,7 @@
 	int32_t open_count;	/* out */
 	uint32_t flags;		/* in/out */
 
-	__kernel_dev_t dev;	/* in/out */
+	devmapper_kernel_dev_t dev;	/* in/out */
 
 	char name[DM_NAME_LEN];	/* device name */
 	char uuid[DM_UUID_LEN];	/* unique identifier for
@@ -60,7 +61,7 @@
 struct dm_target_deps_v1 {
 	uint32_t count;
 
-	__kernel_dev_t dev[0];	/* out */
+	devmapper_kernel_dev_t dev[0];	/* out */
 };
 
 enum {
--- a/libdm/misc/kdev_t.h
+++ b/libdm/misc/kdev_t.h
@@ -15,8 +15,12 @@
 #ifndef _LIBDM_KDEV_H
 #define _LIBDM_KDEV_H
 
+#include <linux/types.h>
+
 #define MAJOR(dev)      ((dev & 0xfff00) >> 8)
 #define MINOR(dev)      ((dev & 0xff) | ((dev >> 12) & 0xfff00))
 #define MKDEV(ma,mi)    ((mi & 0xff) | (ma << 8) | ((mi & ~0xff) << 12))
 
+typedef __u32 devmapper_kernel_dev_t;
+
 #endif
